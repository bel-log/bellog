{"profileName":"Serial Protocol","setupVersion":"4","driverType":"Clipboard","driverSettings":{},"html":[{"id":1,"name":"MESSAGE","code":"<div class=\"notification is-primary is-light lllllllllllllllllllllll\" style=\"margin-bottom: 0.50em\">\n  <div class=\"level\">\n     <div class=\"level-right\">\n        <div>\n          <div>\n            <p class=\"heading\">Cmd ID</p>\n            <p class=\"subtitle is-6\">${$$cmdID}</p>\n          </div>\n        </div>\n      </div>\n  </div>\n  <p class=\"heading\">Data</p>\n  <div>${$$data}</div>\n</div>","parameters":{"cmdID":{"type":"text","default":"cmdID"},"data":{"type":"text","default":"data"}},"events":{}},{"id":3,"name":"ActionGroup2","code":"<div>\n  ${$$title}\n  <div class=\"is-grouped\">\n      <button class=\"button is-primary\" data-iwclick=\"Button1\">${$$button1}</button>\n      <button class=\"button is-primary\" data-iwclick=\"Button2\">${$$button2}</button>\n    </div>\n</div>","parameters":{"title":{"type":"text","default":"title"},"button1":{"type":"text","default":"button1"},"button2":{"type":"text","default":"button2"}},"events":{"Button1":{"type":"iwclick"},"Button2":{"type":"iwclick"}}},{"id":4,"name":"ActionGroup2WithInput","code":"<div class=\"is-flex is-flex-direction-column is-align-items-center\">\n<div class=\"field mb-2\">\n  <div class=\"control\">\n  <label class=\"label\">${$$title}</label>\n    </div>\n  <div class=\"control\">\n     <input id=\"in_${$$ID}\" class=\"input is-primary\" type=\"text\"/>\n  </div>\n</div>\n  <div class=\"is-grouped\">\n      <button class=\"button is-primary\" data-iwclick=\"Button1\">${$$button1}</button>\n      <button class=\"button is-primary\" data-iwclick=\"Button2\">${$$button2}</button>\n    </div>\n</div>","parameters":{"title":{"type":"text","default":"title"},"ID":{"type":"text","default":"ID"},"button1":{"type":"text","default":"button1"},"button2":{"type":"text","default":"button2"}},"events":{"Button1":{"type":"iwclick"},"Button2":{"type":"iwclick"}}},{"id":5,"name":"DoubleInput","code":"<div class=\"is-flex is-flex-direction-column is-align-items-center mb-2\">\n  <div class=\"field is-grouped\">\n    <div class=\"control\">\n      <div class=\"field\">\n        <div class=\"control\">\n          <label class=\"label\">${$$title1}</label>\n        </div>\n        <div class=\"control\">\n          <input class=\"input is-primary\" type=\"text\" style=\"width: 5rem\"  value=\"${TypeID}\" \n            onInput=\"updateTypeID(this);\"/>\n        </div>\n      </div>\n    </div>\n    <div class=\"control\">\n      <div class=\"field\">\n        <div class=\"control\">\n          <label class=\"label\">${$$title2}</label>\n        </div>\n        <div class=\"control\">\n          <input class=\"input is-primary\" type=\"text\" style=\"width: 10rem\" value=\"${UID}\"\n            onInput=\"updateUID(this);\"/>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>","parameters":{"title1":{"type":"text","default":"title1"},"title2":{"type":"text","default":"title2"}},"events":{}},{"id":6,"name":"ButtonWithMargin","code":"<button data-iwclick='buttonClick' class='button is-primary m-2'>${$$text}</button>","parameters":{"text":{"type":"text","default":"text"}},"events":{"buttonClick":{"type":"iwclick"}}}],"actions":[{"id":1,"name":"CLOUD_LED_ON","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x02"},"payload":{"fixed":true,"value":"0101"}}}},{"id":3,"name":"CLOUD_LED_OFF","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x02"},"payload":{"fixed":true,"value":"0100"}}}},{"id":4,"name":"GSM_LED_ON_1","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x02"},"payload":{"fixed":true,"value":"0201"}}}},{"id":5,"name":"GSM_LED_OFF_1","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x02"},"payload":{"fixed":true,"value":"0200"}}}},{"id":7,"name":"GSM_LED_ON_2","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x02"},"payload":{"fixed":true,"value":"0301"}}}},{"id":6,"name":"GSM_LED_OFF_2","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x02"},"payload":{"fixed":true,"value":"0300"}}}},{"id":8,"name":"GSM_LED_ON_3","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x02"},"payload":{"fixed":true,"value":"0401"}}}},{"id":9,"name":"GSM_LED_OFF_3","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x02"},"payload":{"fixed":true,"value":"0400"}}}},{"id":10,"name":"GSM_LED_ON_4","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x02"},"payload":{"fixed":true,"value":"0501"}}}},{"id":11,"name":"GSM_LED_OFF_4","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x02"},"payload":{"fixed":true,"value":"0500"}}}},{"id":2,"name":"TEST_START","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0x22"},"payload":{"fixed":true,"value":"01"}}}},{"id":12,"name":"SET_MAC","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Code","builderBindings":{"code":"function composeAction(state) {\n  // available args keys: cmdID subCmdID payload\n  const elem = document.getElementById(\"in_IDMAC\")\n\n  return {\n    \"cmdID\": \"0a\",\n    \"payload\": \"0100\" + elem.value\n  }\n}"}},{"id":13,"name":"SET_ID32","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Code","builderBindings":{"code":"function composeAction(state) {\n  // available args keys: cmdID subCmdID payload\n  const elem = document.getElementById(\"in_ID32\")\n  const str = elem.value\n  debugger;\n  var arr1 = [];\n  for (var n = 0, l = str.length; n < l; n ++) \n   {\n      var hex = Number(str.charCodeAt(n)).toString(16);\n      arr1.push(hex);\n   }\n\n  return {\n    \"cmdID\": \"0a\",\n    \"payload\": \"0000\" + arr1.join('')\n  }\n}"}},{"id":14,"name":"GET_MAC","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0b"},"subCmdID":{"fixed":true,"value":"01"},"payload":{"fixed":true,"value":""}}}},{"id":15,"name":"GET_ID32","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"0b"},"subCmdID":{"fixed":true,"value":"02"},"payload":{"fixed":true,"value":""}}}},{"id":16,"name":"GET_PROVISION","builderType":"CustomBuilder","builderCustomID":1,"builderBindingType":"Gui","builderBindings":{"bindings":{"cmdID":{"fixed":true,"value":"bb"},"payload":{"fixed":true,"value":""}}}}],"parsers":[{"id":1,"name":"CGPP_PARSER","code":"function(accumulator, data, onAccept, onRefuse, info) {\n  // This is an example line parser. captures each sequence with terminating \\n or \\r\n  // accumulator: use it to accumulate state of the parser then return it\n  // data: Uin8tArray of received data\n  // onAccept(string, args): call this callback when accumulator is ready and has a valid sequence\n  // onRefuse(string, args): all this to refuse the sequence. Content may be displayed anyway according to view configuration\n  if (typeof data === \"string\") {\n    // Clipboard driver\n    data = hexToBytes(data.replace(/\\s/g, '').trim())\n  }\n\n  let _accumulator = (accumulator === null || accumulator === undefined) ? {\n    pkt: []\n  } : accumulator;\n  for (let i = 0; i < data.length; i++) {\n    _accumulator.pkt.push(data[i])\n    if (data[i] == 0xF5) {\n      onAccept(parsePacket(_accumulator.pkt), info);\n      _accumulator.pkt = []\n    }\n  }\n  return _accumulator;\n}"}],"builders":[{"id":1,"name":"CGPP_BUILDER","code":"function() {\n  // List all argument required to create a packet to send\n  // Bus address, data payload, command code etc\n  const builderArgs = {\n    cmdID: \"\",\n    payload: \"\"\n  }\n\n  function builderFunc(args) {\n    // This function will be called to build a packet to send\n    // Call sendFunc to set the data to send. Can be either a string or Uint8Array\n    function hexToBytes(hex) {\n        for (var bytes = [], c = 0; c < hex.length; c += 2)\n            bytes.push(parseInt(hex.substr(c, 2), 16));\n        return bytes;\n    }\n    var payload = hexToBytes(args.payload)\n    return buildPacket(parseInt(TypeID, 16), parseInt(UID, 16), \n                       parseInt(args.cmdID, 16), payload)\n  }  \n\n  return [builderArgs, builderFunc];\n}"}],"scripts":[{"id":1,"name":"helper.js","code":"// Convert a hex string to a byte array\nfunction hexToBytes(hex) {\n    for (var bytes = [], c = 0; c < hex.length; c += 2)\n        bytes.push(parseInt(hex.substr(c, 2), 16));\n    return bytes;\n}\n\nfunction crc16(data, offset, length) {\n    if (data == null || offset < 0 || offset > data.length - 1 || offset + length > data.length) {\n        return 0;\n    }\n\n    crc = 0xFFFF;\n    for (i = 0; i < length; ++i) {\n        crc ^= data[offset + i] << 8;\n        for (j = 0; j < 8; ++j) {\n            crc = (crc & 0x8000) > 0 ? (crc << 1) ^ 0x1021 : crc << 1;\n        }\n    }\n    return crc & 0xFFFF;\n}\n\n\n\n"},{"id":2,"name":"cgpp.js","code":"function parsePacket(dataArray) {\n  var crc = 0, len = 0, cmd = 0;\n  cmd = dataArray[0]\n  len = dataArray.length\n  crc = dataArray[len-3] | (dataArray[len-2] << 8)\n  if(crc16(dataArray, 0, dataArray.length-3) !== crc)\n    return {evt: \"crcError\"}\n\n  return {\n    evt: \"pkt\",\n    cmd: cmd,\n    payload: dataArray.slice(2, dataArray.length-3)\n  }\n}\n\nvar buildSequence = 0\nfunction buildPacket(typeID, UID, cmdID, payload) {\n  var crc = 0;\n  var packetToSend = [];\n  packetToSend.push(cmdID)\n  packetToSend.push(payload.length + 2)\n\n  packetToSend.push(typeID)\n  packetToSend.push(UID)\n  for(var i=0; i < payload.length; i++) {\n    packetToSend.push(payload[i])\n  }\n\n  crc = crc16(packetToSend, 0, packetToSend.length)\n\n  packetToSend.push(crc & 0xFF)\n  packetToSend.push((crc >> 8) & 0xFF)\n\n  packetToSend.push(0xF5)\n\n  return new Uint8Array(packetToSend)\n}"},{"id":3,"name":"globals.js","code":"var UID = \"96\"\nvar TypeID = \"08\"\n\nfunction updateUID(e) {\n  UID = e.value\n}\n\nfunction updateTypeID(e) {\n  TypeID = e.value\n}"}],"styles":[],"views":[{"id":1,"name":"Main","parserType":"CustomParser","customParserID":1,"parserSettings":{},"matchers":[{"id":4,"name":"Match FA","disabled":false,"resolver":"ObjectCompare","resolverParam":{"code":"function customObjectCompare(state, parsedData) {\n  // state: can be set to keep persistent state between compares.\n  // parsedData: string or object according to parser usage\n  // retrun an object with key pair of items to render and result status\n  // keys must always be present when the function returns\n  if(parsedData) {\n    const hex = num => \"0x\" + (num).toString(16).toUpperCase().padStart(2, '0')\n    if (parsedData.evt === \"pkt\")\n      return {\n        result: true,\n        data: {\n          cmdID: hex(parsedData.cmd),\n          data: parsedData.payload.map((it) => hex(it)).join(\" \")\n        }\n      };\n  }\n\n  // Dummy result is used why setup for previewing available html bindings\n  return {\n    result: false,\n    data: {\n      cmdID: \"\",\n      data: \"\",\n    }\n  };\n}"},"accepted":true,"refused":false,"consumeMatch":true,"transmitted":true,"received":true,"widgetMode":false,"safeHtml":true,"widgetID":0,"htmlComponentType":"Custom","htmlCustomID":1,"htmlComponentBindingType":"Gui","htmlComponentBindings":{"bindings":{"cmdID":{"fixed":false,"value":"cmdID","item":"cmdID"},"data":{"fixed":false,"value":"data","item":"data"}}}},{"id":1,"name":"All Rx","disabled":false,"resolver":"Any","resolverParam":{"text":""},"accepted":true,"refused":false,"consumeMatch":true,"transmitted":false,"received":true,"widgetMode":false,"safeHtml":true,"widgetID":0,"htmlComponentType":"Div","htmlCustomID":0,"htmlComponentBindingType":"Gui","htmlComponentBindings":{"bindings":{"color":{"fixed":true,"value":"#000000","item":"All"},"content":{"fixed":false,"value":"","item":"All"}}}},{"id":2,"name":"All Tx","disabled":false,"resolver":"Any","resolverParam":{"text":""},"accepted":true,"refused":false,"consumeMatch":true,"transmitted":true,"received":false,"widgetMode":false,"safeHtml":true,"widgetID":0,"htmlComponentType":"Div","htmlCustomID":0,"htmlComponentBindingType":"Gui","htmlComponentBindings":{"bindings":{"color":{"fixed":true,"value":"#7ed3ff","item":"All"},"content":{"fixed":false,"value":"","item":"All"}}}},{"id":3,"name":"All Refused","disabled":false,"resolver":"Any","resolverParam":{"text":""},"accepted":true,"refused":true,"consumeMatch":true,"transmitted":true,"received":true,"widgetMode":false,"safeHtml":true,"widgetID":0,"htmlComponentType":"Div","htmlCustomID":0,"htmlComponentBindingType":"Gui","htmlComponentBindings":{"bindings":{"color":{"fixed":true,"value":"#FF0000","item":"All"},"content":{"fixed":false,"value":"","item":"All"}}}}],"widgetFrameSize":30,"widgetGroupIds":[{"id":1}],"autoWrap":true},{"id":2,"name":"Raw","parserType":"RawParser","customParserID":0,"parserSettings":{},"matchers":[{"id":1,"name":"All Rx","disabled":false,"resolver":"Any","resolverParam":{"text":""},"accepted":true,"refused":false,"consumeMatch":true,"transmitted":false,"received":true,"widgetMode":false,"safeHtml":true,"widgetID":0,"htmlComponentType":"Span","htmlCustomID":0,"htmlComponentBindingType":"Gui","htmlComponentBindings":{"bindings":{"color":{"fixed":true,"value":"#000000","item":"All"},"content":{"fixed":false,"value":"","item":"All"}}}},{"id":2,"name":"All Tx","disabled":false,"resolver":"Any","resolverParam":{"text":""},"accepted":true,"refused":false,"consumeMatch":true,"transmitted":true,"received":false,"widgetMode":false,"safeHtml":true,"widgetID":0,"htmlComponentType":"Span","htmlCustomID":0,"htmlComponentBindingType":"Gui","htmlComponentBindings":{"bindings":{"color":{"fixed":true,"value":"#7ed3ff","item":"All"},"content":{"fixed":false,"value":"","item":"All"}}}},{"id":3,"name":"All Refused","disabled":false,"resolver":"Any","resolverParam":{"text":""},"accepted":true,"refused":true,"consumeMatch":true,"transmitted":true,"received":true,"widgetMode":false,"safeHtml":true,"widgetID":0,"htmlComponentType":"Span","htmlCustomID":0,"htmlComponentBindingType":"Gui","htmlComponentBindings":{"bindings":{"color":{"fixed":true,"value":"#FF0000","item":"All"},"content":{"fixed":false,"value":"","item":"All"}}}}],"widgetFrameSize":30,"widgetGroupIds":[],"autoWrap":true}],"widgetGroups":[{"id":1,"name":"Commands","widgets":[{"id":8,"name":"Addressing","disabled":false,"htmlComponentType":"Custom","htmlCustomID":5,"bindings":{"title1":{"value":"TypeID"},"title2":{"value":"UID"}},"actions":{}},{"id":9,"name":"Start","disabled":false,"htmlComponentType":"Button","htmlCustomID":0,"bindings":{"text":{"value":"Test Start"}},"actions":{"buttonClick":{"htmlEventKey":"buttonClick","actionID":2}}},{"id":1,"name":"LED Cloud","disabled":false,"htmlComponentType":"Custom","htmlCustomID":3,"bindings":{"title":{"value":"LED Cloud"},"button1":{"value":"ON"},"button2":{"value":"OFF"}},"actions":{"Button1":{"htmlEventKey":"Button1","actionID":1},"Button2":{"htmlEventKey":"Button2","actionID":3}}},{"id":2,"name":"LED GSM 1","disabled":false,"htmlComponentType":"Custom","htmlCustomID":3,"bindings":{"title":{"value":"LED GSM 1"},"button1":{"value":"ON"},"button2":{"value":"OFF"}},"actions":{"Button1":{"htmlEventKey":"Button1","actionID":4},"Button2":{"htmlEventKey":"Button2","actionID":5}}},{"id":3,"name":"LED GSM 2","disabled":false,"htmlComponentType":"Custom","htmlCustomID":3,"bindings":{"title":{"value":"LED GSM 2"},"button1":{"value":"ON"},"button2":{"value":"OFF"}},"actions":{"Button1":{"htmlEventKey":"Button1","actionID":7},"Button2":{"htmlEventKey":"Button2","actionID":6}}},{"id":4,"name":"LED GSM 3","disabled":false,"htmlComponentType":"Custom","htmlCustomID":3,"bindings":{"title":{"value":"LED GSM 3"},"button1":{"value":"ON"},"button2":{"value":"OFF"}},"actions":{"Button1":{"htmlEventKey":"Button1","actionID":8},"Button2":{"htmlEventKey":"Button2","actionID":9}}},{"id":5,"name":"LED GSM 4","disabled":false,"htmlComponentType":"Custom","htmlCustomID":3,"bindings":{"title":{"value":"LED GSM 4"},"button1":{"value":"ON"},"button2":{"value":"OFF"}},"actions":{"Button1":{"htmlEventKey":"Button1","actionID":10},"Button2":{"htmlEventKey":"Button2","actionID":11}}},{"id":6,"name":"SETID32","disabled":false,"htmlComponentType":"Custom","htmlCustomID":4,"bindings":{"title":{"value":"SETID32"},"ID":{"value":"ID32"},"button1":{"value":"SET"},"button2":{"value":"GET"}},"actions":{"Button1":{"htmlEventKey":"Button1","actionID":13},"Button2":{"htmlEventKey":"Button2","actionID":15}}},{"id":7,"name":"SETMAC","disabled":false,"htmlComponentType":"Custom","htmlCustomID":4,"bindings":{"title":{"value":"SETMAC"},"ID":{"value":"IDMAC"},"button1":{"value":"SET"},"button2":{"value":"GET"}},"actions":{"Button1":{"htmlEventKey":"Button1","actionID":12},"Button2":{"htmlEventKey":"Button2","actionID":14}}},{"id":10,"name":"GETREPORT","disabled":false,"htmlComponentType":"Custom","htmlCustomID":6,"bindings":{"text":{"value":"GET PROVISION"}},"actions":{"buttonClick":{"htmlEventKey":"buttonClick","actionID":16}}}]}],"globalSettings":{"shareDataBetweenViews":true,"maximumItemsPerView":10000}}